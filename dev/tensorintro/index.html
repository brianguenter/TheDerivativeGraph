<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Introduction · TheDerivativeGraph</title><meta name="title" content="Introduction · TheDerivativeGraph"/><meta property="og:title" content="Introduction · TheDerivativeGraph"/><meta property="twitter:title" content="Introduction · TheDerivativeGraph"/><meta name="description" content="Documentation for TheDerivativeGraph."/><meta property="og:description" content="Documentation for TheDerivativeGraph."/><meta property="twitter:description" content="Documentation for TheDerivativeGraph."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">TheDerivativeGraph</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">The Derivative Graph and its use</a></li><li><a class="tocitem" href="../thederivativegraph/">The Derivative Graph</a></li><li><span class="tocitem">Tensor Derivatives</span><ul><li class="is-active"><a class="tocitem" href>Introduction</a></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../matvec/">Matrix vector multiplication</a></li><li><a class="tocitem" href="../matmat/">Matrix matrix multiplication</a></li><li><a class="tocitem" href="../convolution/">Convolution</a></li></ul></li><li><a class="tocitem" href="../theory/">Theory</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tensor Derivatives</a></li><li class="is-active"><a href>Introduction</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Introduction</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/brianguenter/TheDerivativeGraph" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/brianguenter/TheDerivativeGraph/blob/main/docs/src/tensorintro.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><p>To compute tensor derivatives efficiently we will use a symbolic index representation. This has several benefits:</p><ul><li>Unlike other tensor differentiation systems which may apply many complex tensor identities to simplify an expression we will use a single simple operation: tensor contraction.</li><li>In the symbolic index form all operations are scalar which gives the AD algorithm designer great flexibility to rearrange the order of operations. An important use of this feature is operator fusion. Another is tiling.</li><li>Tensor differentiation tends to create tensors that are sparse. This sparsity is represented by constraint equations on the symbolic indices. Only element which satisfy the equations are non-zero which can greatly reduces storage and computation.</li></ul><p>A tensor contraction is a summation along one or more indices. Using Einstein notation a contraction occurs whenever two terms have matching indices. For example, matrix-vector multiplication can be written as a tensor contraction</p><p class="math-container">\[\begin{aligned}
Ab &amp;= \sum\limits_{j} A_{ij}b{j} \\
&amp;= A_{ij}b_j
\end{aligned}\]</p><p>and matrix-matrix multiplication can be written as the tensor contraction <span>$A_{ij}B_{jk}$</span>. </p><p>Convolution is also a tensor contraction (we&#39;ll use the ⨀ symbol for convolution to distinguish it from *):</p><p class="math-container">\[\begin{aligned}
(s \odot f)_{i} &amp;= \sum\limits_{l} s_{i-l}f{l} \\
&amp;= s_{i-l}*f_l
\end{aligned}\]</p><p>Tensor differentiation proceeds in simple steps:</p><ul><li>Write out the indices on the tensor terms. Indices shared between two or more terms indicate a tensor contraction.</li><li>Transform the tensor expression into a function graph.</li><li>Transform the function graph into a derivative graph. Change tensor contractions into summation operation nodes.</li><li>Find the variable being differentiated with respect to and compute index substitutions. </li><li>Propagate the index substitutions up the graph.</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../thederivativegraph/">« The Derivative Graph</a><a class="docs-footer-nextpage" href="../matvec/">Matrix vector multiplication »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.0.1 on <span class="colophon-date" title="Thursday 21 September 2023 19:16">Thursday 21 September 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
